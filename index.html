<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Quant System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a2e;
            color: #e0e0e0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 { font-size: 24px; margin-bottom: 8px; }
        .header p { font-size: 14px; opacity: 0.7; }
        .btn-group {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            color: #fff;
        }
        .btn:active { transform: scale(0.97); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-predict { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-review  { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .btn-status  { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .status-bar {
            margin-top: 24px;
            width: 100%;
            max-width: 400px;
            padding: 16px;
            border-radius: 12px;
            background: #16213e;
            font-size: 14px;
            display: none;
        }
        .status-bar.visible { display: block; }
        .status-bar .line { padding: 4px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ€ NBA Quant System</h1>
        <p>æ™ºèƒ½é‡åŒ–é¢„æµ‹æ§åˆ¶å°</p>
    </div>
    <div class="btn-group">
        <button class="btn btn-predict" onclick="dispatch('predict')">ğŸ“Š ä»Šæ—¥é¢„æµ‹</button>
        <button class="btn btn-review"  onclick="dispatch('review')">ğŸ” å¤ç›˜å­¦ä¹ </button>
        <button class="btn btn-status"  onclick="dispatch('model_status')">ğŸ“ˆ æ¨¡å‹çŠ¶æ€</button>
    </div>
    <div id="status" class="status-bar"></div>
    <script>
        const OWNER = 'sky2rmyth';
        const REPO = 'nba999';
        const WORKFLOWS = {
            predict: 'predict.yml',
            review: 'review.yml',
            model_status: 'model_status.yml'
        };

        function showStatus(msg) {
            var el = document.getElementById('status');
            el.className = 'status-bar visible';
            el.innerHTML = '<div class="line">' + msg + '</div>';
        }

        function dispatch(action) {
            var file = WORKFLOWS[action];
            if (!file) return;
            showStatus('â³ æ­£åœ¨è§¦å‘å·¥ä½œæµ...');

            var token = localStorage.getItem('gh_token');
            if (!token) {
                token = prompt('è¯·è¾“å…¥ GitHub Personal Access Token:');
                if (!token) {
                    showStatus('âŒ éœ€è¦ GitHub Token æ‰èƒ½è§¦å‘å·¥ä½œæµ');
                    return;
                }
                localStorage.setItem('gh_token', token);
            }

            var url = 'https://api.github.com/repos/' + OWNER + '/' + REPO + '/actions/workflows/' + file + '/dispatches';
            fetch(url, {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer ' + token,
                    'Accept': 'application/vnd.github+json'
                },
                body: JSON.stringify({ ref: 'main' })
            }).then(function(resp) {
                if (resp.status === 204) {
                    showStatus('âœ… å·¥ä½œæµå·²è§¦å‘æˆåŠŸ');
                } else if (resp.status === 401 || resp.status === 403) {
                    localStorage.removeItem('gh_token');
                    showStatus('âŒ Token æ— æ•ˆæˆ–æƒé™ä¸è¶³ï¼Œè¯·é‡è¯•');
                } else {
                    showStatus('âŒ è§¦å‘å¤±è´¥ (HTTP ' + resp.status + ')');
                }
            }).catch(function() {
                showStatus('âŒ ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            });
        }

        (function autoDispatch() {
            var params = new URLSearchParams(window.location.search);
            var action = params.get('action');
            if (action && WORKFLOWS[action]) {
                dispatch(action);
            }
        })();
    </script>
</body>
</html>
